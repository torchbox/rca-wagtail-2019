name: CI

on: push

jobs:
  lint:
    uses: ./.github/workflows/lint.yaml

  test:
    uses: ./.github/workflows/test.yaml

  deploy:
    if: contains(github.ref, 'master')
    needs: [lint, test]
    uses: ./.github/workflows/deploy-production.yaml

  deploy:
    if: contains(github.ref, 'dev')
    needs: [lint, test]
    uses: ./.github/workflows/deploy-dev.yaml

  deploy:
    if: contains(github.ref, 'staging')
    needs: [lint, test]
    uses: ./.github/workflows/deploy-staging.yaml

  # this is to test a deployment script
  deploy:
    if: contains(github.ref, 'chore/github-actions')
    needs: [lint, test]
    uses: ./.github/workflows/deploy-dev.yaml
