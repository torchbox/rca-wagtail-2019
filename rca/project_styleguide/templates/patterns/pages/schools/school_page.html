{% extends "patterns/base_page.html" %}
{% load wagtailcore_tags wagtailimages_tags navigation_tags static %}

{% block content %}
<div class="wrapper">
    <section class="section section--main">
        {# hero #}
        {% include "patterns/molecules/hero/hero-schools.html" with modifier="programme" %}
        {% if hero_image %}
            <div class="title-area__credit layout__@large-start-five layout__@large-span-one">
                {% include 'patterns/atoms/image-info/image-info.html' with item=hero_image %}
            </div>
        {% endif %}

        <h1>{{ page.title }}</h1>
         {% if page.introduction %}
            <div class="project-overview__introduction layout__start-one layout__span-two  layout__@large-start-three layout__@large-span-two">
                <h2 class="research-centre-overview__heading section__heading heading heading--five">
                    {{ page.introduction|richtext }}
                </h2>
            </div>
        {% endif %}

        {# key datails #}
        <div class="school-overview__key-details layout__start-one layout__span-two layout__@large-span-one">
            {% include "patterns/molecules/key-details/key-details--school.html" %}
        </div>
        {# nav #}
        {% include "patterns/molecules/tab-nav/tab-nav-school.html" with modifier="bg bg--dark" sticky="true" %}
        {# video and body #}
        {% if page.introduction_image %}
            {% include "patterns/organisms/image-video-block/image-video-block.html" with modal=page.video out_of_grid=True curriculum=False heading=False has_meta=False copy=False subheading=False image=page.introduction_image caption=page.video_caption video=page.video %}
        {% endif %}
        {{ page.body|richtext }}

        {# about #}
        {% if page_teasers %}
            <section class="landing-page__middle section section--start section--opposite-notch bg bg--light">

                <div class="section__row research-spaces">
                    <div class="section__header section__header--bottom-space grid">
                    {% if page_teasers.title %}
                        <h2 class="section__heading section__heading--tight heading heading--two">
                            {{ page_teasers.title }}
                        </h2>
                    {% endif %}
                    {% if page_teasers.summary %}
                        <div class="section__introduction">
                            {{ page_teasers.summary }}
                        </div>
                    {% endif %}
                    </div>
                    <div class="section__content grid">
                        {% include "patterns/organisms/staggered-cards/staggered-cards.html" with staggered_cards=page_teasers.pages %}
                    </div>
                </div>

                {% if featured_image %}
                    <div class="section__notch section__notch--opposite">
                        <div class="section__notch-fill section__notch-fill--second-col"></div>
                    </div>
                {% endif %}

            </section>
        {% endif %}
        {% if page.collaborators_heading %}
            <h3 class="section__heading section__heading--tight heading heading--three">
                {{ page.collaborators_heading }}
            </h3>
        {% endif %}

        {% if page.collaborators %}
            {# TODO - @nick this may need reformating from context to fit the carousel template #}
            {% for c in page.collaborators %}
                {% image c.value.image width-200 height-200 %}
                <a href="{{ c.value.link.url }}">{{ c.value.link.title }}</a>
            {% endfor %}
        {% endif %}

        {% if stats_block %}
            {% include "patterns/organisms/stat-block/stat-block.html" %}
        {% endif %}
        {# Our research #}
        {% if related_projects %}
            <section class="section section--top-space-large bg bg--light">

                <div class="section__row section__row--last-large research-highlights">
                    <div class="section__header grid">
                        <h2 class="section__heading section__heading--primary heading heading--four">
                            {{ page.research_projects_title}}
                            {{ page.research_projects_text }}
                        </h2>
                    </div>
                    <div class="section__content grid">
                        {% include "patterns/organisms/carousel/carousel.html" with carousel=related_projects modifier='carousel carousel--no-margin' datatag='data-carousel' %}
                    </div>
                </div>

            </section>
        {% endif %}
        {% if student_research %}
            <section class="section section--end section--top-space bg bg--light">
                <div class="partnerships">
                    <div class="partnerships__header grid">
                        <h2 class="partnerships__heading heading heading--one">{{ student_research.title }}</h2>
                    </div>
                    <div class="partnerships__carousel">
                        {% include "patterns/organisms/carousel/carousel--square.html" with carousel=student_research.slides modifier='carousel--square' datatag='data-square-carousel' %}
                    </div>

                </div>
                <a href="{{ student_research.link_url }}">{{ student_research.link_text }}</a>
            </section>
        {% endif %}
        {% if page.research_collaborators_heading %}
            <h3 class="section__heading section__heading--tight heading heading--three">
                {{ page.research_collaborators_heading }}
            </h3>
        {% endif %}

        {% if page.research_collaborators %}
            {# TODO - @nick this may need reformating from context to fit the carousel template #}
            {% for c in page.research_collaborators %}
                {% image c.value.image width-200 height-200 %}
                <a href="{{ c.value.link.url }}">{{ c.value.link.title }}</a>
            {% endfor %}
        {% endif %}
        {{ page.external_links }}
        {{ page.research_cta_block }}

        {{ page.body|richtext }}
        {# Our research #}
        {% if related_projects %}
            <section class="section section--top-space-large bg bg--light">

                <div class="section__row section__row--last-large research-highlights">
                    <div class="section__header grid">
                        <h2 class="section__heading section__heading--primary heading heading--four">
                            {{ page.research_projects_title }}
                            {{ page.research_projects_text }}
                        </h2>
                    </div>
                    <div class="section__content grid">
                        {% include "patterns/organisms/carousel/carousel.html" with carousel=related_projects modifier='carousel carousel--no-margin' datatag='data-carousel' %}
                    </div>
                </div>

            </section>
        {% endif %}
        {% if student_research %}
            <section class="section section--end section--top-space bg bg--light">
                <div class="partnerships">
                    <div class="partnerships__header grid">
                        <h2 class="partnerships__heading heading heading--one">{{ student_research.title }}</h2>
                    </div>
                    <div class="partnerships__carousel">
                        {% include "patterns/organisms/carousel/carousel--square.html" with carousel=student_research.slides modifier='carousel--square' datatag='data-square-carousel' %}
                    </div>

                </div>
                <a href="{{ student_research.link_url }}">{{ student_research.link_text }}</a>
            </section>
        {% endif %}
        {% if page.research_collaborators_heading %}
            <h3 class="section__heading section__heading--tight heading heading--three">
                {{ page.research_collaborators_heading }}
            </h3>
        {% endif %}

        {% if page.research_collaborators %}
            {# TODO - @nick this may need reformating from context to fit the carousel template #}
            {% for c in page.research_collaborators %}
                {% image c.value.image width-200 height-200 %}
                <a href="{{ c.value.link.url }}">{{ c.value.link.title }}</a>
            {% endfor %}
        {% endif %}
        {% if stats_block %}
            {% include "patterns/organisms/stat-block/stat-block.html" %}
        {% endif %}

        {{ page.external_links }}
        {{ page.research_cta_block }}
        {# Related Programmes and courses #}
        {# TODO talk with nick about duplicating / altering this tempalte to add the summary text #}
        <div class="section__row">
            {% include "patterns/molecules/relatedcontent/relatedprogrammes.html" with title='Related bits' %}
        </div>
    </section>
</div>
{% endblock %}
