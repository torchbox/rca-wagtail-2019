{% extends "patterns/base_page.html" %}
{% load wagtailcore_tags wagtailimages_tags wagtailsettings_tags static %}
{% get_settings %}

{% block body_class %}
    app--staff-detail
{% endblock %}

{% block title_prefix %}
    {% if page.profile_title %}{{ page.profile_title }}{% endif %} {% if page.profile_firstname %}{{ page.profile_firstname }}{% endif %} {% if page.profile_surname %}{{ page.profile_surname }}{% endif %}
{% endblock %}

{% block content %}

    <div class="page page--no-hero" typeof="schema:Person">

        <header class="page__header bg bg--dark">
            <div class="title-area grid">
                <div class="title-area__content">
                    <nav class="title-area__breadcrumb" aria-label="Breadcrumb">
                        {% include "patterns/molecules/breadcrumb/breadcrumb.html" with breadcrumb=page.breadcrumb %}
                    </nav>
                    {% if page.profile_title or profile_firstname or profile_surname %}
                        <h1 property="schema:name" class="title-area__header heading heading--one">
                            {% if page.profile_title %}
                                <span class="heading heading--three">{{ page.profile_title }}</span>
                            {% endif %}
                            {{ page.profile_firstname }}
                            {{ page.profile_surname }}
                        </h1>
                    {% endif %}

                    {% if page.job_title %}
                        <div class="job-titles">
                            {% for item in page.job_title %}
                                <ul class="job-titles__item">
                                    {% for item in item.titles %}
                                        <li class="job-titles__title">{{ item.label }}</li>
                                    {% endfor %}
                                    <a class="job-titles__department link link--tertiary link--link" href="{{ item.link }}">
                                        {{ item.department }}
                                    </a>
                                </ul>
                            {% endfor %}
                        </div>
                    {% endif %}

                    {% if page.contact_email %}
                        <a class="link link--secondary link--link" href="mailto:{{ page.contact_email }}">
                            <span class="link__label">Email {{ page.contact_email }}</span>
                            <svg width="12" height="8" class="link__icon" aria-hidden="true"><use xlink:href="#arrow"></use></svg>
                        </a>
                    {% endif %}
                </div>
            </div>
        </header>

        {% if page.profile_image %}
            {% include "patterns/atoms/profile-image/profile-image.html" %}
        {% endif %}

        <div class="page__content">

            <section class="section section--start bg bg--dark">

                <div class="section__row programme-overview">
                    <header class="section__header grid">
                        <h2 class="section__heading section__heading--primary heading heading--five" property="schema:description">
                            {{ page.profile_introduction}}
                        </h2>
                    </header>
                    <div class="section__content grid">
                        <div class="programme-overview__key-details">
                            {% include "patterns/molecules/key-details/key-details--staff.html" %}
                        </div>
                        <div class="programme-overview__body">
                            <div class="programme-overview__description rich-text">
                                {{ page.profile_body|safe }}
                            </div>
                        </div>
                    </div>
                </div>

                {% if research_highlights %}
                    <div class="section__row research-highlights">
                        <div class="section__header grid">
                            <h2 class="section__heading section__heading--primary heading heading--four">
                                Research highlights
                            </h2>
                        </div>
                        <div class="section__content grid">
                            {% include "patterns/organisms/carousel/carousel.html" with carousel=research_highlights modifier='carousel' datatag='data-carousel' %}
                        </div>
                    </div>
                {% endif %}

            {% if page.gallery %} 
                <div class="section__notch">
                    <div class="section__notch-fill section__notch-fill--third-col"></div>
                </div>

            </section>

            <section class="section bg bg--light">

                <div class="section__row section__row--first section__row--last">
                    <header class="section__header grid">
                        <h3 class="section__heading section__heading--secondary heading heading--four">
                            Gallery
                        </h3>
                    </header>
                    <div class="section__content">
                        {% include "patterns/organisms/slideshow/slideshow.html" with slideshow=page.gallery modifier='slideshow--author-info' %}
                    </div>
                </div>

            </section>

            <section class="section bg bg--dark">
                <div class="section__notch">
                    <div class="section__notch-fill section__notch-fill--third-col"></div>
                </div>
            {% endif %}

                <div class="section__row short-course-accordion section__row--last">
                    {% include "patterns/organisms/accordion-block/accordion-block.html" with accordion_id='1' accordions=page.accordion title="More about "|add:page.profile_firstname %}
                </div>

                <div class="section__notch">
                    <div class="section__notch-fill section__notch-fill--third-col"></div>
                </div>
            
            </section>
            
            <section class="section section--top-space bg bg--light">
                {% if related_students %}
                    {% include "patterns/organisms/student-listing/student-listing.html" with student_listing=related_students %}
                {% endif %}

                {% if related_links %}
                    {% include "patterns/organisms/related-links/related-links.html" with related_links=related_links title="External links" %}
                {% endif %}
            </section>
            
        </div>

    </div>
{% endblock %}
